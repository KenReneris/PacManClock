/*
 * Mario.cpp
 *  Mario animations
 *
 * Author: Ken Reneris <https://github.com/KenReneris>
 * MIT License
 * ----------------------------------------------------------
 */


#include "platform.h"
#include "Mario.h"

const uint8 PROGMEM k_mario0[] = {
    2, 0,0,0, 3, 0, 15, 16,
    0x00,0x00,0xff, 0xf1,0xd0,0xb1, 0xff,0x00,0x00,
        0xc0, 0x3f, 0x00, 0x00,
        0xf0, 0xff, 0x0f, 0x00,
        0x50, 0xa5, 0x00, 0x00,
        0xa4, 0x69, 0x2a, 0x00,
        0xa4, 0xa5, 0xa9, 0x00,
        0x95, 0x6a, 0x15, 0x00,
        0x80, 0xaa, 0x0a, 0x00,
        0x50, 0x55, 0x00, 0x00,
        0x54, 0x7d, 0x01, 0x00,
        0x54, 0xef, 0x03, 0x00,
        0x54, 0xfd, 0x0f, 0x00,
        0x9c, 0xfa, 0x0f, 0x00,
        0xbc, 0xfe, 0x0f, 0x00,
        0xfc, 0xf3, 0x03, 0x00,
        0x54, 0x50, 0x01, 0x00,
        0x54, 0x51, 0x05, 0x00 };


const uint8 PROGMEM k_mario1[] = {
    2, 0,0,0, 3, 0, 15, 16,
    0x00,0x00,0xff, 0xf1,0xd0,0xb1, 0xff,0x00,0x00,
        0x00, 0x00, 0x00, 0xc0,
        0x00, 0xf0, 0x0f, 0xc0,
        0x00, 0xfc, 0xff, 0xc3,
        0x00, 0x54, 0x29, 0xc0,
        0x00, 0x69, 0x9a, 0xca,
        0x00, 0x69, 0x69, 0xea,
        0x40, 0xa5, 0x5a, 0xc5,
        0x00, 0xa0, 0xaa, 0xc2,
        0x00, 0x55, 0x8d, 0xc0,
        0x80, 0x55, 0xa5, 0xc2,
        0xa0, 0x5f, 0xa5, 0xc0,
        0xf5, 0xff, 0xff, 0xc0,
        0xf5, 0xff, 0x3f, 0xc0,
        0xf5, 0x0f, 0x0f, 0xc0,
        0x01, 0x40, 0x05, 0xc0,
        0x00, 0x40, 0x15, 0xc0 };


const uint8 PROGMEM k_mario2[] = {
    2, 0,0,0, 3, 0, 15, 16,
    0x00,0x00,0xff, 0xf1,0xd0,0xb1, 0xff,0x00,0x00,
        0x00, 0xfc, 0x03, 0x00,
        0x00, 0xff, 0xff, 0x00,
        0x00, 0x55, 0x0a, 0x00,
        0x40, 0x9a, 0xa6, 0x02,
        0x40, 0x5a, 0x9a, 0x0a,
        0x50, 0xa9, 0x56, 0x01,
        0x00, 0xa8, 0xaa, 0x00,
        0x50, 0xf5, 0x05, 0x28,
        0x5a, 0xf5, 0x57, 0x2a,
        0x2a, 0xb5, 0x7f, 0x29,
        0x0a, 0xff, 0x3f, 0x04,
        0xc0, 0xff, 0xff, 0x05,
        0xf0, 0xff, 0xff, 0x05,
        0x54, 0x0f, 0xfc, 0x05,
        0x54, 0x00, 0x00, 0x00,
        0x50, 0x01, 0x00, 0x00 };




/////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
//
//


Mario::RunBy::RunBy()
{
    BitmapBase *mario[] =
                {
                    snew<Bitmap<2>>( 40, k_mario0 ),
                    snew<Bitmap<2>>( 40, k_mario2 ),
                    snew<Bitmap<2>>( 40, k_mario1 ) 
                };

    _mario.InitSprite( mario, countof(mario) );
}


IStoryboard::StartResult
Mario::RunBy::Start()
{
    _mario.Start( Point(-30, 0), Point(1,0) );
    return StartResult( Start_ClockOffTop | Start_DimClock2 );
}


void
Mario::RunBy::Loop()
{
    if ( _mario.SpriteMode() == SpriteBase::Mode::Disabled )
    {
        g_animationManager.ContinueTo( Animation::MarioRunBack, 400 );
    }
}

////////////////////////////////////////


Mario::RunBack::RunBack()
{
    BitmapBase *mario[] =
                {
                    snew<Bitmap<2>>( 40, k_mario0, true ),
                    snew<Bitmap<2>>( 40, k_mario2, true ),
                    snew<Bitmap<2>>( 40, k_mario1, true ) 
                };

    _mario.InitSprite( mario, countof(mario) );
}


IStoryboard::StartResult
Mario::RunBack::Start()
{
    _mario.Start( Point(PANEL_WIDTH+40, 0), Point(-1,0) );
    return Start_ClockOffBottom;
}


void
Mario::RunBack::Loop()
{
    if ( _mario.SpriteMode() == SpriteBase::Mode::Disabled )
    {
        g_animationManager.Done();
    }
}

